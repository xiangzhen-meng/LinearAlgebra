# 线性方程组的解

## 同解关系

### 概述

同解关系是一种 [[等价关系]] 
通常可以在同解方程组中找出最简单的一个代表，取得最易得的解集

通过对增广矩阵进行 [[初等行变换]] 得到的方程组同解

### 定理

#### 定理：增广矩阵行向量组等价则对应的线性方程组同解

设$\boldsymbol{x}$满足方程组
$$
\left\{
\begin{array}{c}
\boldsymbol{a}_1\boldsymbol{x}=b_1, \\
\vdots \\
\boldsymbol{a}_s\boldsymbol{x}=b_s.
\end{array}
\right.
$$
由于$(\tilde{\boldsymbol{a}}_i,\tilde{b}_i)$可由$(\boldsymbol{a}_1,b_1),\cdots,(\boldsymbol{a}_s,b_s)$线性表出，即
$$
\tilde{\boldsymbol{a}}_i=\sum_{k=1}^{s}\alpha_{ik}\boldsymbol{a}_k,\quad \tilde{b}_i=\sum_{k=1}^{s}\alpha_{ik}b_k,
$$
因此
$$
\tilde{\boldsymbol{a}}_i\boldsymbol{x} = \sum_{k=1}^{s}\alpha_{ik}\boldsymbol{a}_k\boldsymbol{x} \\
= \sum_{k=1}^{s}\alpha_{ik}b_k \\
= \tilde{b}_i.
$$
即$\boldsymbol{x}$满足方程组
$$
\left\{
\begin{array}{c}
\tilde{\boldsymbol{a}}_1\boldsymbol{x}=\tilde{b}_1, \\
\vdots \\
\tilde{\boldsymbol{a}}_t\boldsymbol{x}=\tilde{b}_t.
\end{array}
\right.
$$
反之，满足下面的方程组也必然满足上面的方程组。证毕

**值的注意的是**，上述条件并非充要条件，仅有必要性的部分是成立的，充分性的部分不成立。充分性的部分由下述定理给出。也即，对于线性方程组来说，“系数矩阵行向量组等价” 这一条件是强于 "两个系数矩阵秩相等的"

#### 定理：齐次线性方程组同解充要条件是三秩相等

>[!note] 齐次线性方程组等价充要条件是三秩相等
>$Ax=0$ 与 $Bx=0$ 同解的充要条件是 $rank(A)=rank(B)=rank\begin{pmatrix}A \\ B\end{pmatrix}$

充分性上述定理证明完毕

必要性：

由于同解，故有两个齐次线性方程组的基础解系张成同样的解空间，因此基础解系的向量个数相等。故有：
$$
n-rank(A)=n-rank(B)
$$
此即 $rank(A)=rank(B)$

这个定理还可用于判定两个 [[秩#方案一：证明两个矩阵作为系数阵的齐次线性方程组同解|两个矩阵的秩相等]] 

这个定理其实是 [[线性变换#秩-零化度定理 (Rank–nullity theorem)]] 的简化版本

## 线性方程组有解的充要条件

### 齐次线性方程组

齐次线性方程组显然有平凡解即零解，因此不存在无解的情形
若齐次线性方程组有非零解，则必有无穷多组非零解
#### 齐次线性方程组有非零解的充要条件

$$
\mathbf{A}\mathbf{x}=\mathbf{0} \iff \det \mathbf{A} \neq 0
$$
由 [[克莱姆法则 (Cramer's Rule)]] ，系数矩阵为方阵的线性方程组有唯一解的充要条件是行列式等于零，取逆否，则有 行列式不为零等价于方程组有无穷多组解或无解

而显然有齐次线性方程组必有零解，故等价于齐次线性方程组有无穷多组解

### 非齐次线性方程组

不妨设线性方程组为：$\mathbf{A}\mathbf{x}=\mathbf{b}$

显然对于齐次线性方程组，下面的充要条件仍然充要，只不过过于 trivial 了

#### 充要条件一：b 可由系数阵列向量线性表出

形式化地写作：
$$
\mathbf{b}=x_{1}\mathbf{a}_{1}+x_{2}\mathbf{a}_{2}+\dots+x_n\mathbf{a}_n,
$$
这是 trivial 的

#### 充要条件二：经过初等行变换后，阶梯阵零行 $b_{r+1}=0$ 

这是由高斯消元法给出的，也是 trivial 的

另有一个定理的简化形式，能够由充要条件二给出证明：

##### 弗雷德霍姆 (Fredholm) 择一定理

>[!note] 弗雷德霍姆 (Fredholm) 择一定理
>$\mathbf{B}_{m\times n}\mathbf{x}_{n\times 1}=\mathbf{b}_{m\times 1}$ 有解的充要条件是 $$
>\forall \mathbf{y}_{m\times 1} 满足 \mathbf{B}^\top_{n\times m}\mathbf{y}_{m\times 1}=\mathbf{0},必定有 \mathbf{b}^\top_{1\times m}\mathbf{y}_{m\times 1}=0
>$$

**充分性**：

**分析**：

这是不平凡的。证明思路大体如下：使用反证法。假设无解，则由充要条件二，经过高斯消元后，必有增广矩阵阶梯阵 $b_{r+1} \neq 0$ 。而经过高斯消元（此即 $y^\top$ 向量左乘列向量）之后，必定有第 $r+1$ 行前面系数阵部分全为零，而此时增广阵部分不为零，矛盾

**证明一**：

令：原矩阵列向量组为 $\boldsymbol{\beta}_{1},\boldsymbol{\beta}_{2},\dots \boldsymbol{\beta}_n$ 

原方程组无解，则增广矩阵经过高斯消元后，必定有：
$$
\begin{pmatrix}
0 & \dots & 0 &a_{1j_{1}} & \dots & \dots &\dots & | &b_{1}' \\
0 &\dots & 0 &0 &\dots &a_{2j_{2}} & \dots &| & b_{2}' \\
\vdots&\dots&&&&\dots&\dots&|&\vdots \\
0 &\dots&&&&\dots&0 &| &c
\end{pmatrix}
$$
其中有：$c\neq 0$ 
则由高斯消元法，零行由前 $r$ 行进行线性组合得到，则必有向量 $\mathbf{y}$ 满足：
$$
\forall k\in\{1, 2, \dots n\}, s.t.\boldsymbol{\beta}_k^\top\cdot \mathbf{y}=0
$$
另由高斯消元法，增广矩阵多出的那列由相同的线性组合得到，故有：
$$
\mathbf{b}^\top\cdot \mathbf{y}=c\neq 0
$$
这与条件中 $\mathbf{b}^\top\cdot \mathbf{y}=0$ 矛盾，充分性证毕

**证明二**：

这个证明基于 [[线性方程组的解#定理：齐次线性方程组同解充要条件是三秩相等]] 

由于 $B^\top y=0$ 和 $\begin{pmatrix}B^\top  \\ b^\top\end{pmatrix}y=0$ 同解，故有 $rank(B^\top)=rank\begin{pmatrix}B^\top \\ b^\top\end{pmatrix}$
将其转置成行向量，即：$rank(B)=rank(B|b)$，这是有解的充要条件三

**必要性**：

**证明一**：暴力展开

必要性相对容易一些，只要展开即可

令矩阵 $\mathbf{B}_{m\times n}=(a_{ij}), i=1,2,\dots,m;j=1,2,\dots,n$

由有解的条件，知道：
$$
b_i=\sum_{j=1}^{n}a_{ij}x_j
$$
由题述知道：
$$
\forall j\in\{1,2,\dots,m\},\sum_{i=1}^{m}a_{ij}y_i=0
$$
则有（由矩阵可知，求和可以换序）：
$$
\sum_{i=1}^{m}y_ib_i=\sum_{i=1}^{m}y_i\sum_{j=1}^{n}a_{ij}x_j=\sum_{j=1}^{n}x_j\sum_{i=1}^{m}a_{ij}y_i=\sum_{j=1}^{n}x_j\cdot 0=0
$$
必要性证毕

**证明二**：

在学完转置之后，由 [[转置#「脱衣服法则」]] 可以有如下证明：
$$
\mathbf{b}^\top \mathbf{y}=(\mathbf{B}\mathbf{x})^\top \mathbf{y}=\mathbf{x}^\top (\mathbf{B}^\top \mathbf{y})=\mathbf{x}^\top \mathbf{0}=\mathbf{0}
$$
真他妈的简洁

#### 充要条件三：系数矩阵的秩等于增广矩阵的秩

##### 证明一：由充要条件二说明

以下均考察阶梯阵，因为任何矩阵均可通过初等行变换化为阶梯阵，而初等行变换后矩阵的秩不变

条件二推条件三：
若零行 b = 0，则系数阵的零行即为增广矩阵的零行，故行秩相同，故秩相同

条件三推条件二：
显然非零行向量是一个极大无关组，则其加长（增广阵的前 r 行行向量组）必为无关组
由于秩相等，则为极大无关组，则任意 t > r 行增广阵的行向量必然被前 r 行向量组线性可表

由于第 r + 1 行向量可被前 r 行线性表出，故有：
$$
\lambda_{1}\mathbf{a}_{1}' + \lambda_{2}\mathbf{a}_{2}' +\dots+\lambda_r\mathbf{a}_r'=\mathbf{a}_{r+1}'
$$
将上式记为 (1) 式
则取系数阵前 r 列，由于线性无关，故必然有：
$$
\lambda_{1}\mathbf{a}_{1} + \lambda_{2}\mathbf{a}_{2}+\dots+\lambda_r\mathbf{a}_r=\mathbf{0}\iff \lambda_{1}=\lambda_{2}=\dots=\lambda_r=0
$$
这是 (1) 式的一个必要条件，故有：
$$
\mathbf{a}_{r+1}'=\mathbf{0}
$$
证毕
##### 证明二：由线性相关性证明

>[!note] 定理
>"线性方程组 $\mathbf{A}\mathbf{x}=\mathbf{b}$ 有解" 等价于 "$rank(\mathbf{A}|\mathbf{b})=rank(\mathbf{A})$"

由充要条件一，即要证明：

"$\mathbf{b} 能被列向量组 \{\mathbf{a}_{1},\mathbf{a}_{2},\dots \mathbf{a}_m\} 线性表出$" 等价于 "$rank(\mathbf{A}|\mathbf{b})=rank(\mathbf{A})$"

**必要性**

取系数阵列向量组的一个极大无关组。故该极大无关组等价于系数阵列向量组
显然它也是增广矩阵列向量的一个线性无关组

由于列向量 $\mathbf{b}$ 能被其线性表出，则该极大无关组等价于增广矩阵的列向量组

由传递性，系数阵列向量组等价于增广阵列向量组，故秩相等

**充分性**

取出系数阵列向量的极大无关组。显然其为增广阵列向量的一个线性无关组

由于等秩，故其为极大无关组

故 $\mathbf{b}$ 向量被该极大无关组线性可表

## 线性方程组解的结构

### 齐次线性方程组解的结构

#### 解的存在性

这部分内容在之前已经做过了

考察方程组：
$$
\mathbf{A}\mathbf{x}=\mathbf{0}
$$
将 A 矩阵按照行向量的形式写开，可以得到：
$$
\mathbf{A}=
\begin{pmatrix}
\mathbf{a}_{1} \\
\mathbf{a}_{2} \\
\vdots \\
\mathbf{a}_m
\end{pmatrix}
$$
取出其中的极大无关组，不妨令其为前 r 个，则有：
$$
\mathbf{\hat{A}}=
\begin{pmatrix}
\mathbf{a}_{1} \\
\mathbf{a}_{2} \\
\vdots \\
\mathbf{a}_r
\end{pmatrix}
$$
由于极大无关组与原行向量组等价，故有 $\mathbf{\hat{A}}$ 与 $\mathbf{A}$ 对应的方程组同解

显然 $\hat{\mathbf{A}}$ 有非零 r 阶子式，将其取出，令为 $\mathbf{A}_{1}$，并将 $\mathbf{A}_{1}$ 的余子式 $\mathbf{A}_{2}$ 扔到等号右边，将 x 对应，可以得到：
$$
\mathbf{A}_{1}\mathbf{x}_1=-\mathbf{A}_{2}\mathbf{x}_{2}
$$
这样处理得到的方程右侧全部可当作 **自由变量**，而方程左侧是一个 **方阵** 系数阵。对于这些自由变量任意取值，均可以由 [[克莱姆法则 (Cramer's Rule)]] 得到对应的方程组的解

#### 解的结构

对于每一个 $\mathbf{x}_{2}$ 的取值，一定有一组解与其唯一对应。因此，想要 **一网打尽** 所有的解，只需要考虑如何取得所有的 $\mathbf{x}_{2}$ 的取值即可

对于 $\mathbf{x}_{2}$ 写成展开的形式：
$$
\mathbf{x}_{2}=
\begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3} \\
\vdots \\
x_{n-r}
\end{pmatrix}
$$
显然对于任意一个向量，我们都可以将其分解成单位向量的线性组合，也即：
$$
\mathbf{x}_{2}=
x_{1}\begin{pmatrix}
1 \\
0 \\
0 \\
\vdots \\
0\end{pmatrix} +
x_{2}\begin{pmatrix}
0 \\
1 \\
0 \\
\vdots \\
0
\end{pmatrix} + \dots +
x_{n-r}\begin{pmatrix}
0 \\
0 \\
0 \\
\vdots \\
1
\end{pmatrix}=x_{1}\mathbf{e}_{1}+x_{2}\mathbf{e}_{2}+\dots+x_{n-r}\mathbf{e}_{n-r}
$$
但是出于方便考虑，我们不在这个时候直接分解

第 1 步，令 $\mathbf{x}_{2}=\mathbf{e}_{1}$ ，得到 $\mathbf{A}_{1}$ 的第一组 **"单位解"** ，称为 $\boldsymbol{\eta}_{1} '$ 
第 2 步，令 $\mathbf{x}_{2}=\mathbf{e}_{2}$ ，得到 $\boldsymbol{\eta}_2 '$ 
依此续行，直到得到第 n-r 个 **"单位解"** $\boldsymbol{\eta}_{n-r}'$ 

将这些 **"单位解"** 拼上右侧 $\mathbf{x}_{2}$ 的每一个对应的单位向量也即右侧自由变量的单位取值，即可得到原方程组 $\mathbf{A}$ 的所有 **"单位解"**，如下：
$$
\boldsymbol{\eta}_i=\begin{pmatrix}
\eta_{i1} \\
\eta_{i2} \\
\eta_{i3} \\
\vdots \\
\eta_{i,r} \\
0 \\
0 \\
\vdots \\
0 \\
1 （第i+r行）\\
0 \\
\vdots \\
0
\end{pmatrix},i=1,2,3,\dots,n-r
$$
称这样的 $\boldsymbol{\eta}_i$ 组成的集合为线性方程组的一个 **基本解系** 

显然这样的基本解组的线性组合即为线性方程组的所有解，可以写成：
$$
V=\left\{ \sum_{i=1}^{n-r}k_i\boldsymbol{\eta}_{i} |k_i\in \mathbb{F} \right\} 
$$
### 非齐次线性方程组解的结构

对于任意非齐次线性方程组，我们首先利用 [[线性方程组的解#充要条件三：系数矩阵的秩等于增广矩阵的秩]] 判别其是否有解

若有解，我们尝试观察出其一个特解 $\hat{\mathbf{x}}$ 

对于任意的方程组的解 $\mathbf{x}$，都有：
$$
\mathbf{A}\mathbf{x}=\mathbf{b} 且\mathbf{A}\hat{\mathbf{x}}=\mathbf{b}
$$
将两侧对应相减，得到：
$$
\mathbf{A}(\mathbf{x}-\hat{\mathbf{x}})=\mathbf{0}
$$
即为齐次线性方程组。我们利用上述方法求解齐次线性方程组，得到解 $\mathbf{v}$ ，则：
$$
\forall \mathbf{x},\mathbf{x}=\hat{\mathbf{x}}+\mathbf{v}
$$
