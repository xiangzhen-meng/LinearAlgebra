# 矩阵的秩不等式

## 总结

### 对于秩的和的估计

#### 下界

三角不等式
$$
rank(A+B)\leq rank(A)+rank(B)
$$
接长不等式
$$
rank(A|B)\leq rank(A) + rank(B)
$$
#### 上界

分块不等式
$$
rank(A)+rank(B)\leq rank\begin{pmatrix}A & 0\\ C & B\end{pmatrix}
$$
Sylvester 不等式
$$
rank(A)+rank(B)\leq rank(AB) + n
$$
### 对于秩的乘积的估计

#### 上界

乘积的秩不等式
$$
rank(AB) \leq min(rank(A), rank(B))
$$
#### 下界

Sylvester 不等式
$$
rank(A)+rank(B)-n\leq rank(AB)
$$

## 秩的三角不等式

>[!note] 三角不等式
>$$|rank(\mathbf{A})-rank(\mathbf{B})|\leq rank(\mathbf{A}+\mathbf{B})\leq rank(\mathbf{A})+rank(\mathbf{B})$$

### 理解

想象极端情况。假如 A 和 B 所有向量都不线性相关，则等号右侧取等

假如 A 和 B 其中一个被另一个线性表出，则左侧取等

否则都不取等

证明是 trivial 的，略去

## 接长的秩不等式

>[!note] 接长的秩不等式
>$$rank\begin{pmatrix}A\\ B\end{pmatrix}\leq rank(A)+rank(B)$$

选出 A 的行极大无关组，记为集合 $I$ ，并且选出 B 的行极大无关组，记为集合 $J$，则有集合 $I \cup J$ 必定能够线性表出 $\begin{pmatrix}A\\ B\end{pmatrix}$ ，故有：
$$
rank\begin{pmatrix}
A \\
B
\end{pmatrix}\leq \#\{I\cup J\} = rank(A) + rank(B)
$$
证毕

这是容易理解的。如果 A 和 B 的极大无关组中有线性相关的向量，则取不到等号；相应的，如果 A 和 B 的极大无关组任意两个向量之间都线性无关，则可以取等

同样道理，还有不等式：
$$
rank(A|B) \leq rank (A) + rank (B)
$$

同时，也必然有另外的方向的不等式：
$$
rank(A)\leq rank(A|B),rank(B) \leq rank(A|B)
$$
这也即：
$$
\max(rank(A), rank(B))\leq rank(A|B)
$$

## 分块的秩不等式

>[!note] 分块的秩不等式
>$$rank\begin{pmatrix}A & 0\\ C & B\end{pmatrix} \geq rank(A) + rank(B)$$

这个不等式在证明时非常好用。证明如下：

取出 A 的一段极大无关组，显然其接长也是线性无关的，再次取出 B 的一段线性无关组。这两个组的并一定是线性无关的，故一定有线性无关组大小等于 $rank(A)+rank(B)$ 
另外，当 C 不引入新的线性无关关系时，可以取等

对这个不等式，有比较好用的特例：

>[!note] 分块的秩不等式特例
>$$rank\begin{pmatrix}A & 0\\ 0 & B\end{pmatrix} = rank(A) + rank(B)$$

此即取等情形

## 乘积的秩不等式

>[!note] 乘积的秩不等式
>$$rank(AB)\leq \min (rank(A), rank(B))$$

由行空间的视角，这是显然的，也即乘积的每一列可以视作 A 的每一列的线性组合，也可以视作 B 的每一行的线性组合，显然其秩不会大于其中任意一个的秩

## Sylvester 不等式

>[!note] Sylvester 不等式
>给定矩阵 $A_{m\times n}，B_{n\times p}$则有$$rank(A) + rank(B) \leq rank(AB) + n$$

### 方法一：构造 [[矩阵的分块]] 

构造如下矩阵：
$$
\begin{align}
\begin{pmatrix}
A&0 \\
I_n&B
\end{pmatrix} &= \begin{pmatrix}
I&-A \\
0&I
\end{pmatrix}\begin{pmatrix}
A&0 \\
I&B
\end{pmatrix}\begin{pmatrix}
I&-B \\
0&I
\end{pmatrix} \\
&=\begin{pmatrix}
0&-AB \\
I&B
\end{pmatrix}\begin{pmatrix}
I&-B \\
0&I
\end{pmatrix} \\
&=\begin{pmatrix}
0&-AB \\
I&0
\end{pmatrix}
\end{align}
$$
显然有 
$$
rank(RHS)=rank(AB)+rank(I_n)=rank(AB)+n
$$
而由分块的秩不等式，得到：
$$
rank(A)+rank(B)\leq rank\begin{pmatrix}
A&0 \\
I_n&B
\end{pmatrix}
$$
证毕

### 取等条件

#### 取等条件 1

>[!note] 取等条件 1 
>$$\begin{bmatrix}A&0\\I&B\end{bmatrix}\text{ 相抵于 }\begin{bmatrix}A&0\\0&B\end{bmatrix}$$

这是一个取等的充要条件

充分性：由相抵得到等秩，于是取等

必要性：由取等得到等秩，而且两个矩阵同阶，于是相抵

### 推论

>[!note] 推论：零矩阵情形
>若有 $AB=\mathbf{0}$，则成立以下特殊形式$$rank(A)+rank(B)\leq n$$

考察 [[矩阵的逆 (方阵的逆)#伴随矩阵]]，注意到 $AA^*=|A|I$ ，当矩阵奇异时，显然有：
$$
RHS=\mathbf{0}
$$
则左边式子为：
$$
rank(A)+rank(A^*)\leq n
$$
可以分类讨论以下三种情形：
$$
rank(A^*)=\begin{cases} 
n&rank(A)=n \iff|A|\neq 0 \\
1&rank(A)=n-1 \\
0&rank(A)\leq n-2
\end{cases}
$$
第一种情形显然成立
第二种情形，由 Sylvester 不等式推论，显然有 $rank(A^*)\leq 1$ 
另一方面，由秩的定义，由于 $rank(A)=n-1$，必有存在 A 的 n-1 阶子式非零，也即伴随矩阵非零矩阵，故有 $rank(A^*)\geq 1$ ，因此有 $rank(A^*)=1$ 
第三种情形，显然有 A 的任意 n-1 阶子式为零，故伴随矩阵为零矩阵，则秩为零

## Frobenius 不等式

>[!note] Frobenius 不等式
>给定矩阵 $A_{m\times n}, B_{n\times s}, C_{s\times t}$，则有$$rank(AB)+rank(BC)\leq rank(ABC)+rank(B)$$

证明依然需要使用到 [[矩阵的分块]] 

右侧显然需要进行如下分块，目的在于消去 ABC：
$$
\begin{align}
\begin{pmatrix}
ABC&0 \\
0&B
\end{pmatrix}&=\begin{pmatrix}
I&-A \\
0&I
\end{pmatrix}\begin{pmatrix}
ABC&0 \\
0&B
\end{pmatrix}\begin{pmatrix}
I&0 \\
C&I
\end{pmatrix} \\
&=\begin{pmatrix}
0&-AB \\
BC&B
\end{pmatrix}
\end{align}
$$
考察左侧，有：
$$
rank(LHS)=rank(ABC)+rank(B)=rank(RHS)
$$
考察右侧，有：
$$
rank(AB)+rank(BC)\leq rank(RHS)
$$
证毕

可以证明，此不等式与 Sylvester 秩不等式等价
